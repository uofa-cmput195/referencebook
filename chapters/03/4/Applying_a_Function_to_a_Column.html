
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.4. Manipulation and Transformation of Tabular data &#8212; Introduction to Principles and Techniques of Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-148221575-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/03/4/Applying_a_Function_to_a_Column';</script>
    <link rel="canonical" href="https://uofa-cmput195.github.io/referencebook/chapters/03/4/Applying_a_Function_to_a_Column.html" />
    <link rel="icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="prev" title="3.3. Cross-Classifying by More than One Variable" href="../3/Cross-Classifying_by_More_than_One_Variable.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Introduction to Principles and Techniques of Data Science - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Introduction to Principles and Techniques of Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01/what-is-data-science.html">1. Data Science</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../01/1/intro.html">1.1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../01/1/1/computational-tools.html">1.1.1. Computational Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01/1/2/statistical-techniques.html">1.1.2. Statistical Techniques</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../01/2/why-data-science.html">1.2. Why Data Science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/3/importance-and-impact-of-datascience.html">1.3. Importance and Impact of Data Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/4/applications-and%20use-cases.html">1.4. Key Applications and Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/5/Data_Science_Life_Cycle.html">1.5. Data Science Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/6/Summary-1.html">1.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02/causality-and-experiments.html">2. Causality and Experiments</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../02/1/observation-and-visualization-john-snow-and-the-broad-street-pump.html">2.1. John Snow and the Broad Street Pump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/2/snow-s-grand-experiment.html">2.2. Snow’s “Grand Experiment”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/3/establishing-causality.html">2.3. Establishing Causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/4/randomization.html">2.4. Randomization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/5/endnote.html">2.5. Endnote</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Tables.html">3. Working with Tabular Data</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1/Index-Slice.html">3.1. Selecting and Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/Classifying_by_One_Variable.html">3.2. Classifying by One Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/Cross-Classifying_by_More_than_One_Variable.html">3.3. Cross-Classifying by More than One Variable</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.4. Manipulation and Transformation</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/uofa-cmput195/referencebook" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/chapters/03/4/Applying_a_Function_to_a_Column.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Manipulation and Transformation of Tabular data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-a-function-to-a-column">3.4.1. Applying a Function to a Column</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-as-values">3.4.1.1. Functions as Values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-functions-to-rows">3.4.2. Applying Functions to Rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-canada-population">3.4.3. Example: Canada Population</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorized-operation-vs-row-wise-apply">3.4.3.1. Vectorized operation vs Row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_remove-input docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="manipulation-and-transformation-of-tabular-data">
<h1><span class="section-number">3.4. </span>Manipulation and Transformation of Tabular data<a class="headerlink" href="#manipulation-and-transformation-of-tabular-data" title="Link to this heading">#</a></h1>
<p>In data science, we often need to perform complex transformations and calculations on our data. So far we have seen some examples of creating new columns of tables by applying functions to existing columns or to other arrays. All of those functions took arrays as their arguments. But frequently we will want to convert the entries in a column by a function that doesn’t take an array as its argument.</p>
<p>For example, it might take just one number as its argument, as in the function <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> defined below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#the function to categorize scores</span>
<span class="k">def</span> <span class="nf">categorize_score</span><span class="p">(</span><span class="n">score</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
    <span class="k">elif</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
    <span class="k">elif</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
    <span class="k">elif</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;D&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;F&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorize_score</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;F&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorize_score</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorize_score</span><span class="p">(</span><span class="mi">76</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;C&#39;
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> simply returns letter grade given a score. Let’s consider a Dataframe containing information about students and their scores in a particular exam. To use this function on many scores at once, we will have to be able to <em>refer</em> to the function itself, without actually calling it. Analogously, we might show a cake recipe to a chef and ask her to use it to bake 6 cakes.  In that scenario, we are not using the recipe to bake any cakes ourselves; our role is merely to refer the chef to the recipe.  Similarly, we can ask a table to call <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> on 6 different numbers in a column.</p>
<p>First, we create the dataframe <code class="docutils literal notranslate"><span class="pre">students</span></code> with a column for Name and Score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>78</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="applying-a-function-to-a-column">
<h2><span class="section-number">3.4.1. </span>Applying a Function to a Column<a class="headerlink" href="#applying-a-function-to-a-column" title="Link to this heading">#</a></h2>
<p>To convert each of the scores to it’s letter grade, we will use a new Table method. The <code class="docutils literal notranslate"><span class="pre">apply</span></code> method calls a function on each element of a column, forming a new array of return values. To indicate which function to call, just name it (without quotation marks or parentheses). The name of the column of input values is a string that must still appear within quotation marks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">categorize_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    B
1    A
2    C
3    D
Name: Score, dtype: object
</pre></div>
</div>
</div>
</div>
<p>What we have done here is <code class="docutils literal notranslate"><span class="pre">apply</span></code> the function <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> to each value in the <code class="docutils literal notranslate"><span class="pre">Score</span></code> column of the table <code class="docutils literal notranslate"><span class="pre">students</span></code>. The output is the array of corresponding return values of the function. For example, 85 became ‘B’, 92 became ‘A’ and so on.</p>
<p>This array, which has the same length as the original <code class="docutils literal notranslate"><span class="pre">Score</span></code> column of the <code class="docutils literal notranslate"><span class="pre">students</span></code> table, can be used as the values in a new column called <code class="docutils literal notranslate"><span class="pre">Letter</span> <span class="pre">Grad</span></code> alongside the existing <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Score</span></code> columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Letter Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">categorize_score</span><span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Score</th>
      <th>Letter Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>85</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>92</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>78</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>64</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="functions-as-values">
<h3><span class="section-number">3.4.1.1. </span>Functions as Values<a class="headerlink" href="#functions-as-values" title="Link to this heading">#</a></h3>
<p>We’ve seen that Python has many kinds of values.  For example, <code class="docutils literal notranslate"><span class="pre">6</span></code> is a number value, <code class="docutils literal notranslate"><span class="pre">&quot;cake&quot;</span></code> is a text value, <code class="docutils literal notranslate"><span class="pre">Table()</span></code> is an empty table, and <code class="docutils literal notranslate"><span class="pre">ages</span></code> is a name for a table value (since we defined it above).</p>
<p>In Python, every function, including <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code>, is also a value. It helps to think about recipes again. A recipe for cake is a real thing, distinct from cakes or ingredients, and you can give it a name like “Ani’s cake recipe.” When we defined <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> with a <code class="docutils literal notranslate"><span class="pre">def</span></code> statement, we actually did two separate things: we created a function that converts a score to letter grade, and we gave it the name <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code>.</p>
<p>We can refer to any function by writing its name, without the parentheses or arguments necessary to actually call it. We did this when we called <code class="docutils literal notranslate"><span class="pre">apply</span></code> above.  When we write a function’s name by itself as the last line in a cell, Python produces a text representation of the function, just like it would print out a number or a string value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorize_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.categorize_score(score)&gt;
</pre></div>
</div>
</div>
</div>
<p>Notice that we did not write <code class="docutils literal notranslate"><span class="pre">&quot;categorize_score&quot;</span></code> with quotes (which is just a piece of text), or <code class="docutils literal notranslate"><span class="pre">categorize_score()</span></code> (which is a function call, and an invalid one at that).  We simply wrote <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code> to refer to the function.</p>
<p>Just like we can define new names for other values, we can define new names for functions.  For example, suppose we want to refer to our function as <code class="docutils literal notranslate"><span class="pre">categorize</span></code> instead of <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code>.  We can just write this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorize</span> <span class="o">=</span> <span class="n">categorize_score</span>
</pre></div>
</div>
</div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">categorize</span></code> is a name for a function.  It’s the same function as <code class="docutils literal notranslate"><span class="pre">categorize_score</span></code>, so the printed value is exactly the same.</p>
<p>categorize</p>
<p>Let us see another application of <code class="docutils literal notranslate"><span class="pre">apply</span></code>.</p>
<ul class="simple">
<li><p>apply() takes an argument that’s common in pandas: <strong>axis</strong>.</p></li>
<li><p>The <strong>axis</strong> argument can be either 0 or 1. By default, it’s zero.</p></li>
<li><p>When axis = 0, the function is applied to a single column.</p></li>
<li><p>When axis = 1, the function is applied to the entire row.</p></li>
</ul>
</section>
</section>
<section id="applying-functions-to-rows">
<h2><span class="section-number">3.4.2. </span>Applying Functions to Rows<a class="headerlink" href="#applying-functions-to-rows" title="Link to this heading">#</a></h2>
<p>Sometimes, we may need to apply a function to a row instead of a column. Let’s see an example. For this example, we will redefine our initial <code class="docutils literal notranslate"><span class="pre">students</span></code> dataframe with an additional column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
    <span class="s1">&#39;Quiz&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">72</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Score</th>
      <th>Quiz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>85</td>
      <td>95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>92</td>
      <td>70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>78</td>
      <td>91</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>64</td>
      <td>72</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Let’s say that, the ‘Quiz’ is worth 10% of their final grade.</p></li>
<li><p>Let’s create a column called <strong>Final_Grade</strong>. To do this, we need to compute:</p></li>
</ul>
<blockquote>
<div><p>(0.9) * (Score) + (0.1) * (Quiz)</p>
</div></blockquote>
<ul class="simple">
<li><p>This formula relies on two columns! If we use axis = 0, we don’t have all of the necessary information.</p></li>
<li><p>Note that when applying to a row, we call apply() on the whole dataframe, not just a single column!</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computeFinalGrade</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
	<span class="n">Score</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span>
	<span class="n">Quiz</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Quiz&#39;</span><span class="p">]</span>

	<span class="n">final_grade</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">Score</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">Quiz</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">final_grade</span>

<span class="n">students</span><span class="p">[</span><span class="s1">&#39;Final_Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">computeFinalGrade</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Score</th>
      <th>Quiz</th>
      <th>Final_Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>85</td>
      <td>95</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>92</td>
      <td>70</td>
      <td>89.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>78</td>
      <td>91</td>
      <td>79.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>64</td>
      <td>72</td>
      <td>64.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="example-canada-population">
<h2><span class="section-number">3.4.3. </span>Example: Canada Population<a class="headerlink" href="#example-canada-population" title="Link to this heading">#</a></h2>
<p>One of the most prevalent applications of the <code class="docutils literal notranslate"><span class="pre">apply</span></code> function is in data preprocessing. While we will explore data preprocessing techniques in greater detail in subsequent chapters, this section provides a brief example to illustrate how <code class="docutils literal notranslate"><span class="pre">apply</span></code> can be utilized for preprocessing tasks.</p>
<p>We will take Canada’s population dataset (in the years 2021 to 2022) for preprocessing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Population</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Geography</th>
      <th>Jan 2021</th>
      <th>Jan 2022</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Canada</td>
      <td>38,058,291</td>
      <td>38,567,576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Newfoundland and Labrador</td>
      <td>525,895</td>
      <td>528,977</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Prince Edward Island</td>
      <td>159,240</td>
      <td>164,195</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nova Scotia</td>
      <td>990,025</td>
      <td>1,010,460</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New Brunswick</td>
      <td>784,950</td>
      <td>798,656</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Quebec</td>
      <td>8,550,561</td>
      <td>8,613,999</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ontario</td>
      <td>14,772,726</td>
      <td>14,999,441</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Manitoba</td>
      <td>1,383,854</td>
      <td>1,400,663</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Saskatchewan</td>
      <td>1,166,348</td>
      <td>1,171,031</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alberta</td>
      <td>4,418,338</td>
      <td>4,465,537</td>
    </tr>
    <tr>
      <th>10</th>
      <td>British Columbia</td>
      <td>5,180,015</td>
      <td>5,286,478</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yukon</td>
      <td>42,157</td>
      <td>43,063</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Northwest Territories 5</td>
      <td>44,432</td>
      <td>44,791</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Nunavut 5</td>
      <td>39,750</td>
      <td>40,285</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we want to calculate the population growth fron year 2021 to 2022 it will throw a Typeerror.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
	<span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2022&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2022&#39;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>Let’s examine the type of each column to understand why the arithmetic operation is causing an error. This issue arises because <code class="docutils literal notranslate"><span class="pre">pandas</span></code> has interpreted the columns as strings instead of numbers, and arithmetic operations cannot be performed on string data types.</p>
<p>To diagnose and resolve this, we can use the <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> attribute of the DataFrame, which will show us the data type of each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Population</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Geography    object
Jan 2021     object
Jan 2022     object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>In this case, both ‘Jan 2022’ and ‘Jan 2021’ are of type object, which typically indicates string data. As you can see the values of these two columns contain commas, these values are interpreted as strings by <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.
To perform arithmetic operations, we need to remove the commas to convert these columns to numeric data types.</p>
<p>Let’s define a function <code class="docutils literal notranslate"><span class="pre">to_number()</span></code> for removing ‘,’ and converting to <code class="docutils literal notranslate"><span class="pre">int</span></code>. Then we will apply the function to both ‘Jan 2022’ and ‘Jan 2021’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_number</span><span class="p">(</span><span class="n">str_count</span><span class="p">):</span>
    <span class="n">num_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_count</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">num_count</span>


<span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2022&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2021&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2021&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">to_number</span><span class="p">)</span>
<span class="n">Population</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Geography</th>
      <th>Jan 2021</th>
      <th>Jan 2022</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Canada</td>
      <td>38058291</td>
      <td>38567576</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Newfoundland and Labrador</td>
      <td>525895</td>
      <td>528977</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Prince Edward Island</td>
      <td>159240</td>
      <td>164195</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nova Scotia</td>
      <td>990025</td>
      <td>1010460</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New Brunswick</td>
      <td>784950</td>
      <td>798656</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Quebec</td>
      <td>8550561</td>
      <td>8613999</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ontario</td>
      <td>14772726</td>
      <td>14999441</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Manitoba</td>
      <td>1383854</td>
      <td>1400663</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Saskatchewan</td>
      <td>1166348</td>
      <td>1171031</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alberta</td>
      <td>4418338</td>
      <td>4465537</td>
    </tr>
    <tr>
      <th>10</th>
      <td>British Columbia</td>
      <td>5180015</td>
      <td>5286478</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yukon</td>
      <td>42157</td>
      <td>43063</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Northwest Territories 5</td>
      <td>44432</td>
      <td>44791</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Nunavut 5</td>
      <td>39750</td>
      <td>40285</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Population</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Geography    object
Jan 2021      int64
Jan 2022      int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now as  both columns ‘Jan 2022’ and ‘Jan 2021’ are integer type we can calculate the percentage of population growth within one year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Population</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%G</span><span class="s1">rowth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2022&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2021&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">Population</span><span class="p">[</span><span class="s1">&#39;Jan 2021&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">Population</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Geography</th>
      <th>Jan 2021</th>
      <th>Jan 2022</th>
      <th>%Growth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Canada</td>
      <td>38058291</td>
      <td>38567576</td>
      <td>1.338171</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Newfoundland and Labrador</td>
      <td>525895</td>
      <td>528977</td>
      <td>0.586049</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Prince Edward Island</td>
      <td>159240</td>
      <td>164195</td>
      <td>3.111655</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nova Scotia</td>
      <td>990025</td>
      <td>1010460</td>
      <td>2.064089</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New Brunswick</td>
      <td>784950</td>
      <td>798656</td>
      <td>1.746098</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Quebec</td>
      <td>8550561</td>
      <td>8613999</td>
      <td>0.741916</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ontario</td>
      <td>14772726</td>
      <td>14999441</td>
      <td>1.534686</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Manitoba</td>
      <td>1383854</td>
      <td>1400663</td>
      <td>1.214651</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Saskatchewan</td>
      <td>1166348</td>
      <td>1171031</td>
      <td>0.401510</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alberta</td>
      <td>4418338</td>
      <td>4465537</td>
      <td>1.068252</td>
    </tr>
    <tr>
      <th>10</th>
      <td>British Columbia</td>
      <td>5180015</td>
      <td>5286478</td>
      <td>2.055264</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Yukon</td>
      <td>42157</td>
      <td>43063</td>
      <td>2.149109</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Northwest Territories 5</td>
      <td>44432</td>
      <td>44791</td>
      <td>0.807976</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Nunavut 5</td>
      <td>39750</td>
      <td>40285</td>
      <td>1.345912</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="vectorized-operation-vs-row-wise-apply">
<h3><span class="section-number">3.4.3.1. </span>Vectorized operation vs Row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code><a class="headerlink" href="#vectorized-operation-vs-row-wise-apply" title="Link to this heading">#</a></h3>
<p>You might consider calculating the ‘%Growth’ column using row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code>. While this approach will yield correct results, you may wonder why vectorized operations are preferred over row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code>. The reason is that vectorized operations are not only simpler but also more efficient in terms of performance and memory usage.</p>
<p>So, when is row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code> appropriate? In brief, row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code> is preferable in situations where vectorized operations are either infeasible or too complex to implement.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/03/4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../3/Cross-Classifying_by_More_than_One_Variable.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.3. </span>Cross-Classifying by More than One Variable</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-a-function-to-a-column">3.4.1. Applying a Function to a Column</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-as-values">3.4.1.1. Functions as Values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-functions-to-rows">3.4.2. Applying Functions to Rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-canada-population">3.4.3. Example: Canada Population</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorized-operation-vs-row-wise-apply">3.4.3.1. Vectorized operation vs Row-wise <code class="docutils literal notranslate"><span class="pre">apply</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rejwana Haque
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>